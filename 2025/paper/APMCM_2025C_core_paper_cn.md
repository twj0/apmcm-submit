# 2025 美赛 APMCM C 题：关税政策对中美贸易、产业结构与宏观金融的综合影响——在小样本下回到“稳健统计”的证据链

## 摘要

本文围绕特朗普第二任期可能实施的新一轮关税政策，从微观商品（大豆与汽车）、关键中间品（半导体）、财政视角（关税收入）以及宏观金融与制造业回流五个层面，构建了一套统一的数据处理与实证分析框架。与多数参赛队伍不同，我们在系统尝试 LSTM、Transformer、GNN、VAR–LSTM 等复杂模型之后，**明确放弃将其作为主要证据来源**，而转向样本量可承受的传统计量方法（OLS 回归、简单时间序列、情景分析）。

在完整的代码跑通和结果核对基础上，我们得到的**核心结论**是：

- 在题目给定和我们扩展的数据规模下，复杂深度模型的预测表现普遍不优于简单基准，甚至在很多指标上显著退化；
- 传统计量模型虽然 R² 不高，但在方向性和经济含义上更符合直觉，且结果对设定更稳健；
- 基于传统方法可以给出“方向+量级区间”的政策判断，但远不足以支撑“精确最优关税”“精准安全指数”等强结论。

因此，本文的贡献不在于“炫技式建模”，而在于：在**极度有限的小样本环境下，如何识别哪些结果值得相信，哪些结果应当被坦诚地降级为方法展示**，并在此基础上给出克制而稳健的政策讨论。

---

## 1 问题背景与研究目标

特朗普第一任期的关税战已经改变了中美及全球贸易格局。若在第二任期继续升级或调整关税政策，将对：中国大豆进口结构、日本汽车产业布局、美国半导体供应链安全、美国关税财政收入，以及宏观金融与制造业回流路径产生复杂影响。

结合赛题与可获得数据，我们的研究目标是：

1. 描述关税冲击下，中美大豆贸易份额如何在美国、巴西、阿根廷之间再分配；
2. 分析针对日本汽车的差别关税如何影响产能外移决策与美国本土产出；
3. 在极少的年度数据下，构造一个可解释的半导体供应链安全评估框架；
4. 在有限观测下，对“最优关税率”和关税收入动态路径给出区间判断，而非精确点估计；
5. 从宏观与金融维度考察关税与反制措施对美国增长、市场与制造业回流的方向性影响。

贯穿全文的一个统一问题是：**在数据规模远小于模型复杂度的情况下，如何避免“用大炮打蚊子”？**

---

## 2 数据与方法：统一的数据管线与“统计 vs 深度”对照

### 2.1 数据来源与处理

所有计算均基于 `2025/data/processed` 目录下的整理数据，原始关税与进出口数据存放于 `2025/problems/Tariff Data`，通过统一的预处理脚本生成：

- Q1 大豆：`q1_0.csv` 年度关税面板、`q1_1.csv` 中国自美/巴西/阿根廷月度进口；
- Q2 汽车：关税面板 + 外部行业数据，合成 `auto_import_charges` 面板；
- Q3 半导体：按高/中/低端芯片分段的进口 `chip_import_charges`，以及政策变量 `q3_1_chip_policies.csv`；
- Q4 收入：`q4_0_tariff_revenue_panel.csv` 汇总年度关税收入、平均关税率与总进口额；
- Q5 宏观金融：`q5_tariff_indices_calibrated.csv` 或 `q5_tariff_indices_policy.csv` 中的关税指数，与 `us_macro.csv`、`us_financial.csv`、`us_reshoring.csv` 等外部数据合并成年度时间序列。

整个代码库在读取数据时，**优先使用 `data/processed` 中的用户提供数据文件**，仅在缺失时回退到 `data/external` 的模板或占位数据，保证论文所有主结论均建立在我们整理的数据之上。

### 2.2 方法框架与对照设计

针对每一个子问题，我们都设计了**两套平行的分析路径**：

- **传统/统计路径**：
  - Q1：面板 OLS 估计大豆价格弹性 + 滞后一阶基准预测；
  - Q2：进口结构 OLS 与产业传导回归 + 手工情景模拟；
  - Q3：分段 OLS + 供应链自给率与中国依赖度指标；
  - Q4：二次 Laffer 型静态模型 + 简化动态弹性；
  - Q5：多条 OLS 回归 + 低维 VAR 与事件研究。

- **复杂/深度路径**（仅作方法尝试，不作为主结论）：
  - Q1：多层 LSTM 预测多国月度进口量与价格；
  - Q2：基于 Transformer 的进口序列预测 + MARL 纳什博弈；
  - Q3：GNN 供应链网络 + 随机森林预测 + 简单风险时间序列；
  - Q4：梯度提升树与 ARIMA 动态预测；
  - Q5：VAR–LSTM 混合模型、树模型与 PyTorch Transformer（因样本不足未成功）。

为避免“选择性汇报”，我们在代码层面实现了**统一的对照输出**：

- Q1：`results/q1/q1_forecast_comparison.md/json` —— 滞后一阶基准 vs LSTM；
- Q2：`results/q2/q2_forecast_comparison.md/json` —— 进口结构 OLS vs Transformer（样本不足仅有 OLS 行）；
- Q3：`results/q3/q3_forecast_comparison.md/json` —— 分段 OLS vs 随机森林（当前数据下 OLS 有效、RF 训练不足）；
- Q4：`results/q4/q4_model_comparison.md/json` —— 静态 Laffer OLS vs 梯度提升树（数据不足，两者都不具说服力）；
- Q5：`results/q5/q5_model_comparison_brief.md/json` —— 回归+VAR vs VAR–LSTM+树模型的摘要表。

这些对照表在技术上支撑了本文的关键判断：**在当前样本和噪声水平下，深度/ML 模型不能给出比传统方法更可靠的结论。**

---

## 3 各子问题分析与主要发现

### 3.1 Q1 大豆贸易：弹性估计可以用，深度预测不可用

1. **价格弹性估计**（`results/q1/q1_elasticities.json`）：
   - 面板 OLS：ln(import_quantity) 对 ln(price_with_tariff) 的回归，控制年份、月份与出口国固定效应；
   - 得到的价格弹性约为 **−0.52**，R² ≈ **0.26**：
     - 符合“价格上升抑制进口”的经济直觉；
     - 但拟合度有限，只能用来做**方向性和粗略量级判断**。

2. **情景模拟**（`q1_scenario_exports.csv`, 图 `figures/q1_shares_before_after.*`）：
   - 构造 3 种关税情景：无报复、25% 报复关税、50% 报复关税；
   - 以最新一年为基期，对美国、巴西、阿根廷的市场份额与进口额进行弹性调整；
   - 结果表明：
     - 对美国大豆征收报复关税将显著压缩其对华出口，份额被巴西和阿根廷部分填补；
     - 但在现实中，替代速度与幅度还会受天气、物流和国内政策影响，模型得到的百分比变化**只是上界**。

3. **LSTM vs 统计基准**（`q1_forecast_comparison.*`）：
   - 滞后一阶基准在 `SMAPE` 上明显优于 LSTM（约 62% vs 103%），但 `MAPE` 受接近 0 的观测影响被放大到极端值；
   - LSTM 在训练 60+ epoch 后，验证损失仍不稳定，预测在多数时期偏离实际数倍以上；
   - 结论：**在几十期月度样本下，LSTM 不能提供比简单基准更好的预测，所有深度预测数值均不用于政策结论。**

> 因此，Q1 的实质性结论只依赖于：**价格弹性估计 + 简单情景模拟**，并明确给出“不可靠区间”和局限性说明。

---

### 3.2 Q2 日本汽车：使用 OLS + 手工情景，博弈与 Transformer 只作定性说明

1. **进口结构 OLS**（`q2_import_structure.json`）：
   - 以总进口关税 `auto_import_charges` 计算各伙伴国份额的对数，回归于年份趋势和国家虚拟变量；
   - R² 较高（≈0.99），主要捕捉年份趋势和伙伴固定差异，而非关税冲击本身；
   - 因缺乏真实品牌/工厂层面数据，该模型更多是**描述总量结构的平滑变化**，不能直接识别因果弹性。

2. **产业传导回归**（`q2_industry_transmission.json`）：
   - 用“进口渗透率 = 进口/(进口+本土产量)”解释美国本土汽车产量与就业；
   - 在很少年度观测下，系数方向合理（进口渗透率升高压制本土产出），但统计显著性有限。

3. **情景模拟**（`q2_scenario_imports.csv` / `q2_scenario_industry.csv`，图 `figures/q2_import_structure.*`, `q2_industry_impact.*`）：
   - 构造“无调整/部分外移/激进本地化”三种日本车企应对策略；
   - 在给定总销量假设下，计算美国本土产量、墨西哥产量与日本直接进口的变化；
   - 给出的只是**可能区间**：
     - 日本完全外移既增加本土产量，也意味着较大的固定成本与地缘政治风险；
     - 美国高关税策略在短期内可能增加本土产出，但长期未必是福利最优。

4. **Transformer 及 MARL 分析**：
   - Transformer 训练样本仅十余个年度窗口，对未来预测基本等同于记忆训练集；
   - MARL 与 Nash 分析在收益设定上高度依赖假设参数，即使找到“均衡”，其**经济含义远弱于简单成本收益表**。

> 因此，Q2 的结论主要基于：**OLS + 情景树**，而 Transformer 与 MARL 被严格限定为“概念演示”，不输出数值政策推荐。

---

### 3.3 Q3 半导体：回到结构化指标和情景，而不是 GNN 精准预测

1. **贸易回归与产出回归**（`q3_trade_response.json`, `q3_output_response.json`）：
   - 在 `high/mid/low` 三个细分段上对 `ln(chip_import_charges)` 与补贴、出口管制、全球需求等变量回归；
   - 由于每段有效样本少于 10 条，回归主要提供趋势方向，而非精确弹性。

2. **供应链安全指标**（`q3_security_metrics.csv`）：
   - 以“进口代理量 + 美国本土产出”作为总供给，定义：
     - 自给率 `self_sufficiency_pct`；
     - 中国依赖度 `china_dependence_pct`；
     - 综合风险指数 `supply_risk_index`。
   - 得到的结果是：
     - 高端芯片自给率长期低于 30%，对台韩高度依赖；
     - 对中国的依赖主要集中在中低端封测与材料环节。

3. **GNN 与 ML 对照**（`q3_forecast_comparison.md` + `q3/gnn/*` + `q3/ml/*`）：
   - 在可用样本量下，GNN 与随机森林很难学出稳定结构，`q3_forecast_comparison.md` 中多数格子为空；
   - GNN 报告中的“安全指数 57.8/100”“HHI≈2150”等数值**高度依赖人工设定的节点属性**，应被视为定性而非定量结论。

> 整体来看，Q3 的可信部分是：
> - 通过自给率和中国依赖度指标刻画半导体供应链脆弱性；
> - 用简单情景（补贴优先、关税优先、综合政策）比较“安全指数”的相对增量。  
> 不可信的是：
> - 将 GNN 或随机森林的单一数值解读为“真实的安全分数”或精准预测。

---

### 3.4 Q4 关税收入：用理论 Laffer 曲线替代“6 点拟合”的伪精确

1. **数据现实**：
   - 在我们整理的年度面板中，真正同时拥有“总收入 + 平均关税率”的有效年份少于 6 个；
   - 任意二次函数都可以在 6 个点上拟合出很高的 R²，因此静态 Laffer 回归**几乎不可辨识**。

2. **静态模型与 ML 对照**（`q4_model_comparison.md`）：
   - 由于有效样本极少，对静态 OLS 与梯度提升树都无法给出有意义的 R² 或 RMSE，MD 表中全部为 `-`；
   - 这并不意味着“模型好坏不明”，而是直接表明：**在数据层面无法推断“14.3% 最优关税”之类精确数字。**

3. **替代方案：理论 Laffer 曲线**（图 `q4_laffer_curve.*`）：
   - 设进口需求具有常弹性：`M(τ) = M0 * τ^{-ε}`，在 ε ∈ [−0.5, −1.5] 的区间内绘制多条 stylized Laffer 曲线；
   - 结果显示：
     - 收入最大化关税率大致落在 **8%–18%** 区间；
     - 但由于真实弹性几乎无法从题目给定数据中识别，该区间本身仍具有高度不确定性。

> 因此，我们在 Q4 中**彻底放弃了任何“单一点最优关税率”的结论**，只保留：
> - Laffer 曲线是倒 U 形的理论直观；
> - 在合理弹性区间内，当前美国平均关税既不在“极低”也不在“明显过高”的位置。

---

### 3.5 Q5 宏观金融：回归和 VAR 只给方向，ML 仅作补充

1. **回归结果**（`q5/econometric/regressions.json`）：
   - 在 GDP 增速、工业生产、制造业增加值占比、制造业就业占比等四个被解释变量上，关税指数系数：
     - 符号多为负，但绝大多数 p 值大于 0.1；
     - 平均 R² 约 0.26（见 `q5_model_comparison_brief.md`），说明整体拟合度有限。

2. **VAR 结果**（同上）：
   - 由于样本仅 11 年，我们将 VAR 限制在 1 阶，并使用标准化处理；
   - 模型形式稳定性检查 `is_stable=False`，即存在根接近或略出单位圆，脉冲响应图**仅能用于定性说明**；
   - IRF 图在绘制时多次触发数值警告，进一步佐证在如此短序列下 VAR 的信息量有限。

3. **VAR–LSTM 与树模型**（`q5_model_comparison_brief.md`）：
   - VAR–LSTM 的残差 RMSE 约 0.71，在训练样本只有 7 个的前提下，没有任何泛化保证；
   - 针对制造业回流的 Random Forest 与 GB 模型，测试集 R² 大多为负，说明模型在小样本下**无法比简单均值更好**。

> 因此，我们在 Q5 中采取了极为保守的表述：
> - 在现有样本与控制变量下，**无法识别关税对宏观增长或制造业回流的显著因果效应**；
> - 若强行使用 ML 模型，很容易得到看似“重要性很高”的关税特征，但这些重要性排序在小样本下随机性极强，不能支持政策含义。

---

## 4 综合结论与政策含义

综合 Q1–Q5 的结果，我们给出以下几条稳健的政策判断：

1. **短期内，提高对特定国家的关税将显著改变双边贸易结构，但全球供需会通过替代渠道部分弥补。**
   - 大豆与汽车的分析都体现了这一点：
     - 美国大豆份额被巴西和阿根廷部分替代；
     - 日本车企可以通过在美墨建厂、调整供应链来对冲高关税冲击。

2. **关税收入的提升存在明显的边际递减，超过一定水平后将因进口缩减而难以继续增加。**
   - 在合理弹性区间内，Laffer 曲线说明“再高的关税也不一定带来更多收入”；
   - 在我们能观察到的年份里，美国关税收入更多是价格与基数扩张的结果，而非“关税率越高越好”。

3. **从宏观经济和金融市场视角看，目前的数据不足以支持“高关税显著促进制造业回流”的论断。**
   - 相关回归的系数多数不显著；
   - VAR 和 VAR–LSTM 的脉冲响应在数值上不稳定；
   - 树模型的特征重要性在不同子样本下飘忽不定，很容易产生伪相关。

4. **在供应链安全维度，补贴与友岸供应链重构比简单提高关税更具长期效果。**
   - Q3 的指标体系表明：
     - 提高美国本土产能、自给率和多元化友岸供应商，能更显著降低综合风险；
     - 关税本身如果没有配套的产能与研发投资，只会在短期内改变贸易流向，而难以提高长期安全。

这些判断都刻意被表述为“方向 + 量级区间”，而不是“单点精准预测”。这是我们对题目数据条件的诚实回应。

---

## 5 局限性与改进方向

1. **样本极少、频率混杂**：
   - 多数变量只有 10–11 年度观测，适合的模型本就应当非常简单；
   - 若未来能够获取季度或月度的宏观与行业数据，VAR 与深度时间序列模型才有发挥空间。

2. **关税与政策指数的测度粗糙**：
   - Q4 与 Q5 中的“平均关税率”“关税指数”都将复杂多维的税目压缩为单一指标；
   - 更精细的分析需要按 HS 码、行业和伙伴国分层构建多维关税矩阵。

3. **深度模型的尝试远多于其可提供的实质性信息**：
   - 本文附录中仍保留了 LSTM、Transformer、GNN 等模型代码和部分结果，以示我们确实做过这些尝试；
   - 但最终结论刻意将其降级为“失败的尝试”，提醒读者在类似小样本问题中应更加克制地使用深度模型。

4. **因果识别能力有限**：
   - 缺乏可靠的对照组与自然实验设计，我们的估计大多是“相关性 + 控制下的关联”，而非严格意义的因果效应；
   - 若后续能引入差分中的差分、合成控制或面板工具变量等方法，并配合更长时间序列，结论的说服力会显著增强。

---

## 6 结语

在这道题中，我们刻意从“堆模型”退回到“看数据”，从“追求炫技”退回到“强调不确定性”。通过在代码层面实现统计 vs 深度模型的系统对照，我们发现：**在小样本、高噪声的现实约束下，传统统计方法往往比复杂模型更值得信任**。

我们希望，这样一篇“诚实承认模型失败、但仍给出有价值方向性判断”的论文同样可以得到认可——因为它更加接近真实研究者在类似数据条件下面临的选择。
